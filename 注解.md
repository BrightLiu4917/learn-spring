### 使用注解案例
1 新增枚举类 PermissionEnum.java
```java
package com.liuweiliang.demo1.enums;

import lombok.Getter;

/**
 * 权限枚举：限定系统所有权限类型，删除账户仅支持SUPER_ADMIN
 */
@Getter // Lombok生成getter，方便AOP/业务层获取属性
public enum PermissionEnum {
    /**
     * 超级管理员：拥有所有权限（包含删除账户）
     * 普通管理员：仅拥有查询/编辑等基础权限，无删除权限
     */
    SUPER_ADMIN(1, "超级管理员", "拥有账户删除、配置等所有系统权限"),
    ADMIN(0, "普通管理员", "仅拥有账户查询、编辑等基础权限，无删除权限");

    // 权限码：存入JWT，轻量易传输
    private final Integer permCode;
    // 权限名称：前端展示/日志打印
    private final String permName;
    // 权限描述：详细说明，便于维护
    private final String permDesc;

    // 枚举构造器必须为private，外部无法new
    PermissionEnum(Integer permCode, String permName, String permDesc) {
        this.permCode = permCode;
        this.permName = permName;
        this.permDesc = permDesc;
    }

    /**
     * 辅助方法：根据权限码获取枚举（核心：JWT解析出权限码后转成枚举，方便对比）
     * @param permCode 权限码（0=超级管理员，1=普通管理员）
     * @return 对应的权限枚举，默认返回普通管理员
     */
    public static PermissionEnum getByCode(Integer permCode) {
        for (PermissionEnum perm : PermissionEnum.values()) {
            if (perm.getPermCode().equals(permCode)) {
                return perm;
            }
        }
        // 非法权限码默认返回普通管理员（降低系统风险）
        return ADMIN;
    }
}
```


2 新增注解 RequirePermission.java 
```java
package com.liuweiliang.demo1.annotation;

import com.liuweiliang.demo1.enums.PermissionEnum;

import java.lang.annotation.*;

/**
 * 权限控制注解：标记方法需要的权限类型，仅拥有对应权限的用户可调用
 * 作用于：方法
 * 保留策略：运行时（AOP需要在运行时解析注解）
 */
@Target({ElementType.METHOD}) // 仅允许贴在方法上（接口/Service方法）
@Retention(RetentionPolicy.RUNTIME) // 运行时保留，AOP才能解析 只有运行时保留的注解才能被AOP解析
@Documented // 生成API文档时显示该注解，便于团队协作
public @interface RequirePermission {
    /**
     * 注解属性：方法需要的权限类型
     * 默认值：普通管理员（ADMIN），删除账户接口手动指定为超级管理员（SUPER_ADMIN）
     */
    PermissionEnum value() default PermissionEnum.ADMIN;
}
```

3 新增拦截器 PermissionInterceptor.java
```java
package com.liuweiliang.demo1.aspect;

import com.liuweiliang.demo1.annotation.RequirePermission;
import com.liuweiliang.demo1.common.Result;
import com.liuweiliang.demo1.enums.PermissionEnum;
import com.liuweiliang.demo1.util.JwtUtil;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.springframework.stereotype.Component;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;
import java.util.Map;

@Aspect // 声明切面  类
@Component // 交给Spring管理
public class PermissionAspect {

    @Resource// 注入JwtUtil
    private JwtUtil jwtUtil;

    // 拦截所有贴了@RequirePermission的方法
    @Around("@annotation(requirePermission)")// 它通过 @Aspect 注解标记为切面类，配合 @Around("@annotation(requirePermission)") 环绕通知，精准拦截所有标注了 @RequirePermission 的接口（比如超级管理员才能访问的删除 API）。
    public Object checkPermission(ProceedingJoinPoint joinPoint, RequirePermission requirePermission) throws Throwable {
        // 1. 从注解里获取枚举值（用户要求的权限）

        PermissionEnum requiredPerm = requirePermission.value();
        System.out.println("需要的权限：" + requiredPerm.getPermDesc() + "（码：" + requiredPerm.getPermCode() + "）");

        // 2. 获取当前登录用户的权限（模拟：从token解析，实际业务从数据库/缓存取）
        HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest();

        String token = request.getHeader("Authorization");

        Map<String, Object> authInfo = jwtUtil.parseToken(token.substring(7).trim());

        PermissionEnum userPerm = getPermByCode((int) authInfo.get("permCode"));

        // 3. 权限校验：判断当前用户是否有要求的权限
        if (!requiredPerm.equals(userPerm)) {
            return Result.fail(403, "无权限：需要" + requiredPerm.getPermDesc() + "权限");
        }

        // 4. 权限通过，执行原方法
        return joinPoint.proceed();
    }

    // 辅助方法：根据权限码获取枚举（模拟）
    private PermissionEnum getPermByCode(int code) {
        for (PermissionEnum perm : PermissionEnum.values()) {
            if (perm.getPermCode() == code) {
                return perm;
            }
        }
        return PermissionEnum.ADMIN;
    }
}
```